---
layout: post
title:  vue 爬坑之路（持续更新）
date:   2017-08-30 09:08:00 +0800
categories: vue
tag: 教程
---

* content
{:toc}


前言
===========================
我使用vue进行开发前端页面已经半年多时间了，从最开始只看官方文档，自己写demo，到后来接触公司vue项目，渐渐成为一名重度vue使用依赖者，几乎现在的开发已经不使用jQuery了。但是，有时维护公司的老项目，又要去看那些代码，感觉像是看一件件古董，它们虽然写的也很完美，很精致，细细读完，也能感叹`造物者`精妙的设计。但是，对于公司不断扩张的需求和周期很短的项目开发，这种老的开发模式就像古董一样没有了使用价值。在单页面应用于组件化开发横行的今天，vue的使用，让我在代码开发过程中感到了如鱼得水。本篇主要记录，vue新手在开发过程中可能会遇到的一些奇异的百思不得其解的问题，这些其实都跟vue的一些机制有关，让我们一起走进它们。

data中 对象的属性附加问题
==========================

场景
--------------------------
实际项目开发过程中会经常遇到，我们从后台接口获取一些对象组成的list，然后在模板里面通过`v-for`渲染这些数据，然而，我们不仅仅要展示这些数据，我们可能需要对每一项有一些交互动作，从而改变对象数据的某些状态，这些状态属性可能接口并没有定义返回给我们，那就需要我们自己给数组中的对象添加一些额外的属性。

例子
-------------------------------
![云盘图片](/styles/images/yupan.png)
以最近开发的云盘的项目为例，从图中可以看到，每个文件都需要一个状态来表示当前是否是处于被用户选中的状态，然而，后台查询接口返回的`fileList`里每个`file`对象里面是肯定没有这个属性的，因为这是前台的交互行为附加的属性。那么，我们怎么去加上这个属性呢？如果，想法是用户点击这个文件的时候，给这个文件对象加上附加属性。代码可能是这样的：
	chooseFile(item){
		item.choosed?item.choosed=false:item.choosed=true;
    },
这样的问题是什么呢，就是点击文件并不会出现选中的小勾，而这时，那个点击的文件对象的choosed属性值也确实是true，而这边这样写的样式确没有加载出来
	<div  :class = "{checked:item.choosed,check:!item.choosed}"></div>
这时，就有点抓狂了，你会对着`console`里面打印出来的file的choosed属性值 和 页面上并不相称的渲染结果陷入深思。。。难道是vue数据渲染机制出bug了吗？

解决
------------------------------------
首先，我们看看官网上的一段话：
>由于 JavaScript 的限制， Vue 不能检测以下变动的数组：
>1.当你利用索引直接设置一个项时，例如： vm.items[indexOfItem] = newValue
>2.当你修改数组的长度时，例如： vm.items.length = newLength
> 解决第一类问题：Vue.set(example1.items, indexOfItem, newValue)
>解决第二类问题：数组整体的重新替换

因为官网上举例用的是数组，所以，新手给对象的属性赋值就会出现上面的错误，所以，刚刚的代码可以这样写
	chooseFile(item){
		item.choosed?this.$set(item,'choosed',false):this.$set(item,'choosed',true);
    },
那么，你学到了吗？